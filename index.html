<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Portofolio Rangga Abi Yasha, 3D Artist dan Desainer Grafis. Lihat karya Blender, ZBrush, dan lainnya.">
  <title>Portofolio — Rangga Abi Yasha</title>

  <!-- Font: Space Mono -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9cZ9gz6fBwQffrwLkzCmO8cFTV0E8iBvOJvsg5d94pjYjbc0hlZbTV7R3Xy1QCMSaBhPgzofNYZhC+JGg5Og==" crossorigin="anonymous" referrerpolicy="no-referrer">

  <style>
    :root{
      --bg-dark:#0b0f14;
      --panel:#0f1728;
      --muted:#9aa4b2;
      --accent:#ff9800; /* oranye */
      --glass: rgba(255,255,255,0.03);
      --accent-glow: 0 10px 30px rgba(255,152,0,0.08);
      --maxw:1200px;
      --mono: 'Space Mono', monospace;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:var(--mono), monospace;background:linear-gradient(180deg,#080b10 0%, #05070a 100%);color:#eaf3fb;-webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}

    /* Header */
    header{
      position:sticky;top:0;z-index:60;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(15,17,32,0.8), rgba(15,17,32,0.45));
      border-bottom: 1px solid rgba(255,255,255,0.03);
      box-shadow: 0 6px 24px rgba(0,0,0,0.6);
    }
    nav{max-width:var(--maxw);margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:0.85rem 1rem}
    nav h1{font-size:1rem;color:var(--accent);margin:0}
    .nav-right{display:flex;align-items:center;gap:1rem}
    .nav-links{display:flex;gap:14px;align-items:center}
    .nav-links a{padding:8px 10px;border-radius:8px;text-decoration:none;color:var(--muted);font-weight:700;font-size:0.95rem}
    .nav-links a.active, .nav-links a:hover{background:var(--glass);color:var(--accent)}
    .nav-links.active{display:flex !important;flex-direction:column;position:absolute;top:100%;left:0;right:0;background:linear-gradient(180deg,var(--panel),#0f1728);border-top:1px solid rgba(255,255,255,0.03);padding:1rem;border-radius:0 0 12px 12px;box-shadow:0 8px 30px rgba(0,0,0,0.6)}

    /* Mobile Menu Toggle */
    .mobile-menu-toggle{display:none;flex-direction:column;cursor:pointer;padding:8px;border-radius:6px;background:var(--glass)}
    .mobile-menu-toggle span{width:20px;height:2px;background:var(--muted);margin:3px 0;transition:0.3s}
    .mobile-menu-toggle.active span:nth-child(1){transform:rotate(-45deg) translate(-5px,5px)}
    .mobile-menu-toggle.active span:nth-child(2){opacity:0}
    .mobile-menu-toggle.active span:nth-child(3){transform:rotate(45deg) translate(-5px,-5px)}

    /* HERO full-screen bg */
    .hero{
      min-height:84vh;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:2.5rem 2rem;
      background-image: url('IMAGES/back.jpg');
      background-size:cover;
      background-position:center;
      position:relative;
      overflow:hidden;
    }
    .hero::after{
      content:'';
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      background:linear-gradient(135deg, rgba(5,7,10,0.8) 0%, rgba(5,7,10,0.4) 50%, rgba(5,7,10,0.8) 100%);
      z-index:1;
    }
    .hero img{ display:none; } /* hide broken bg if needed */
    .hero-content{position:relative;z-index:3;max-width:900px}
    .hero h1{font-size:3rem;margin:0 0 0.5rem;color:#fff;text-shadow:0 2px 10px rgba(0,0,0,0.5)}
    .hero p{margin:0 0 1rem;color:var(--muted);font-size:1.05rem;text-shadow:0 1px 5px rgba(0,0,0,0.3)}
    .btn, button[type=submit]{
      display:inline-block;padding:12px 22px;border-radius:999px;background:var(--accent);color:#081019;text-decoration:none;font-weight:800;box-shadow:var(--accent-glow);
      transition:transform .2s,box-shadow .2s;
      position:relative;z-index:3;
    }
    .btn:hover{transform:translateY(-4px);box-shadow:0 18px 40px rgba(255,152,0,0.16)}

    /* container */
    .container{max-width:var(--maxw);margin:0 auto;padding:0 1rem}

    /* About */
    .about{display:flex;gap:2.5rem;align-items:center;justify-content:space-between;padding:4rem 2rem;max-width:var(--maxw);margin:0 auto}
    .about-image{flex:0 0 420px;position:relative}
    .about-image img{width:420px;height:420px;object-fit:cover;border-radius:20px;border:6px solid rgba(255,152,0,0.07);box-shadow:0 28px 60px rgba(2,6,23,0.6);transition:transform .3s ease}
    .about-image img:hover{transform:scale(1.02)}
    .about-image::before{content:'';position:absolute;inset:-10px;border-radius:25px;background:linear-gradient(45deg, rgba(255,152,0,0.1), transparent);opacity:0;transition:opacity .3s ease;z-index:-1}
    .about-image:hover::before{opacity:1}
    .about-content{flex:1}
    .about-content h2{margin:0 0 0.75rem;color:var(--accent);font-size:2rem}
    .about-content p{color:var(--muted);line-height:1.9;font-size:1.05rem}

    /* Skills */
    .skills{background:linear-gradient(180deg, rgba(255,152,0,0.02), rgba(255,152,0,0.01));padding:4rem 2rem}
    .section-head{max-width:var(--maxw);margin:0 auto 1rem;padding:0 1rem}
    .section-head h2{color:#fff;margin:0;font-size:1.8rem}

    .skills-grid{max-width:1400px;margin:1.25rem auto;display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;padding:0 1rem}
    .skill-card{
      background:linear-gradient(180deg,var(--panel), #07101a);
      border-radius:14px;padding:1rem;box-shadow:0 8px 30px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02);display:flex;flex-direction:column;
      transition:transform .3s ease, box-shadow .3s ease;
      cursor:pointer;
    }
    .skill-card:hover{transform:translateY(-5px);box-shadow:0 15px 40px rgba(0,0,0,0.8), 0 0 20px rgba(255,152,0,0.1)}
    .skill-card h3{margin:0 0 0.5rem;color: #fff;font-size:1.05rem}
    .skill-card p{margin:0;color:var(--muted);font-size:0.95rem}
    .skill-card .btn{margin-top:auto; font-size:0.8rem; padding:8px 16px; text-align:center;}
    .skill-row{display:flex;align-items:center;justify-content:space-between;margin-top:10px}
    .progress{background:rgba(255,255,255,0.04);height:12px;border-radius:999px;margin:10px 0;overflow:hidden;flex:1;margin-right:12px}
    .progress .progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),#f6c26a);width:0;transition:width 0.9s cubic-bezier(.2,.9,.2,1)}

    /* make 2 rows with 3 columns -> grid above handles 3 columns; for 2 rows just ensure enough cards exist */

    /* Portfolio */
    .portfolio{padding:4rem 2rem}
    .portfolio-grid{max-width:var(--maxw);margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.25rem;padding:0 1rem}
    .portfolio .card{background:linear-gradient(180deg,#071427,#05101b);border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.02);transition:transform .3s ease, box-shadow .3s ease; display:flex; flex-direction:column;}
    .portfolio .card:hover{transform:translateY(-8px);box-shadow:0 20px 50px rgba(0,0,0,0.8), 0 0 25px rgba(255,152,0,0.1)}
    .portfolio img{width:100%;height:220px;object-fit:cover;display:block;transition:transform .3s ease}
    .portfolio .card:hover img{transform:scale(1.05)}
    .portfolio .card-content{padding:1rem; flex-grow:1; display:flex; flex-direction:column;}
    .portfolio .card h3{margin:0 0 0.5rem;}
    .portfolio .card p{margin:0;color:var(--muted); flex-grow:1;}
    .portfolio-filters{display:flex;gap:1rem;margin-bottom:2rem;flex-wrap:wrap;align-items:center;}
    .portfolio-filters input, .portfolio-filters select{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;font-family:inherit;}
    .portfolio-filters input{flex:1;min-width:200px;}

    /* Styles for active filter select */
    #filterSelect.filter-active {
      background: var(--accent);
      color: var(--bg-dark); /* Dark text on accent background */
      border-color: var(--accent);
    }
    /* Styles for cards in filtered view */
    .portfolio-grid.filtered-view .card {
      background: linear-gradient(180deg, #1a2a40, #101a2a); /* Slightly different background */
      color: #eaf3fb; /* Brighter text color for better readability */
    }

    /* Traditional & digital */
    .gallery-art{padding:4rem 2rem}
    .art-grid{max-width:var(--maxw);margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;padding:0 1rem}
    .art-item{position:relative;overflow:hidden;border-radius:12px}
    .art-item img{width:100%;height:320px;object-fit:cover;border-radius:10px;transition:transform .3s,box-shadow .3s}
    .art-item img:hover{transform:scale(1.03);box-shadow:0 20px 45px rgba(0,0,0,0.6)}
    .art-item::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, rgba(255,152,0,0.1), transparent);opacity:0;transition:opacity .3s ease;z-index:1}
    .art-item:hover::before{opacity:1}

    /* Gallery photos */
    .photo-gallery{padding:3rem 2rem}
    .photo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;max-width:var(--maxw);margin:0 auto;padding:0 1rem}
    .photo-grid img{width:100%;height:160px;object-fit:cover;border-radius:12px;transition:transform .3s ease, box-shadow .3s ease;cursor:pointer;border:2px solid transparent}
    .photo-grid img:hover{transform:scale(1.05);box-shadow:0 15px 35px rgba(0,0,0,0.4);border-color:var(--accent)}
    .photo-grid .photo-item{position:relative;overflow:hidden;border-radius:12px}
    .photo-grid .photo-item::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, rgba(255,152,0,0.1), transparent);opacity:0;transition:opacity .3s ease}
    .photo-grid .photo-item:hover::before{opacity:1}
    .photo-grid .photo-overlay{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(to top, rgba(0,0,0,0.8), transparent);padding:15px;color:#fff;transform:translateY(100%);transition:transform .3s ease}
    .photo-grid .photo-item:hover .photo-overlay{transform:translateY(0)}
    .photo-grid .photo-overlay h4{margin:0;font-size:1rem}
    .photo-grid .photo-overlay p{margin:5px 0 0;font-size:0.85rem;color:#ccc}

    /* Upload section */
    .upload{padding:4rem 2rem;background:linear-gradient(180deg,#07141b,#061018);border-top:1px solid rgba(255,255,255,0.02)}
    .upload .card{max-width:920px;margin:0 auto;padding:16px;border-radius:10px;background:linear-gradient(180deg,#08121a,#061018)}
    .upload label{display:block;margin-top:8px;color:var(--muted);font-weight:700}
    .upload input[type=file], .upload textarea, .upload select, .upload input[type=number]{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;margin-top:6px}
    .upload .row{display:flex;gap:10px;flex-wrap:wrap}
    .upload .col{flex:1;min-width:140px}

    /* Social */
    .contact{padding:4rem 2rem;background:linear-gradient(180deg,#041018,#031018);border-top:1px solid rgba(255,255,255,0.02)}
    .contact-grid{display:flex;gap:12px;justify-content:center;align-items:center;flex-wrap:wrap}
    .contact-grid a{width:56px;height:56px;border-radius:999px;background:linear-gradient(180deg,var(--accent),#e68a00);display:inline-flex;align-items:center;justify-content:center;color:#071019;font-size:20px;text-decoration:none;box-shadow:var(--accent-glow);transition:transform .3s ease, box-shadow .3s ease}
    .contact-grid a:hover{transform:translateY(-3px) scale(1.1);box-shadow:0 15px 35px rgba(255,152,0,0.3)}

    /* modal analyzer */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;padding:2rem;opacity:0;pointer-events:none;transition:opacity .3s ease, transform .3s ease;transform:scale(0.9);z-index:9999}
    .modal.open{opacity:1;pointer-events:auto;transform:scale(1)}
    .modal .inner{max-width:1000px;width:100%;background:#081018;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.05);box-shadow:0 20px 60px rgba(0,0,0,0.8), 0 0 20px rgba(255,152,0,0.1)}
    .modal img{width:100%;height:auto;border-radius:8px}
    .modal .meta{padding:8px 6px;color:var(--muted)}
    .modal .delete-btn{background:var(--accent);color:#081019;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-weight:700;margin-top:10px;transition:transform .2s ease, box-shadow .2s ease}
    .modal .delete-btn:hover{background:#e68a00;transform:translateY(-2px);box-shadow:0 10px 25px rgba(255,152,0,0.3)}

    /* lightbox for gallery */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .3s}
    .lightbox.open{opacity:1;pointer-events:auto}
    .lightbox img{max-width:90%;max-height:90%;object-fit:contain}
    .lightbox .close{position:absolute;top:20px;right:20px;color:#fff;font-size:30px;cursor:pointer}

    /* utility */
    .to-top{position:fixed;right:18px;bottom:18px;width:48px;height:48px;border-radius:10px;background:linear-gradient(180deg,#0b1318,#071018);display:flex;align-items:center;justify-content:center;color:var(--muted);border:1px solid rgba(255,255,255,0.03);cursor:pointer;box-shadow:0 8px 30px rgba(0,0,0,0.6);transition:transform .3s ease, box-shadow .3s ease}
    .to-top:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 12px 35px rgba(0,0,0,0.8), 0 0 15px rgba(255,152,0,0.2)}
    @media (max-width:1200px){
      .about{flex-direction:column;align-items:center;text-align:center}
      .about-image img{width:300px;height:300px}
      .skills-grid{grid-template-columns:repeat(3,1fr)}
      .hero h1{font-size:2.5rem}
      .hero p{font-size:1.1rem; max-width: 80%; margin-left: auto; margin-right: auto;}
    }
    @media (max-width:900px){
      .skills-grid{grid-template-columns:repeat(2,1fr)}
      .hero h1{font-size:2.2rem}
      .hero p{font-size:1rem}
      .about-image img{width:280px;height:280px}
      .portfolio-grid{grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
      .art-grid{grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
      .photo-grid{grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
    }
    @media (max-width:700px){
      .nav-links{display:none;}
      .mobile-menu-toggle{display:flex; z-index: 100;}
      .skills-grid{grid-template-columns:1fr}
      .about-image img{width:240px;height:240px}
      .hero{min-height:70vh;padding:3rem 1.5rem}
      .hero h1{font-size:2rem; line-height: 1.3;}
      .hero p{font-size:0.95rem}
      .portfolio-grid{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
      .art-grid{grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
      .photo-grid{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
      .photo-grid .photo-overlay{padding:12px}
      .photo-grid .photo-overlay h4{font-size:0.9rem}
      .photo-grid .photo-overlay p{font-size:0.8rem}
      .section-head h2{font-size:1.6rem}
      .about-content h2{font-size:1.8rem}
      .portfolio h2{font-size:1.6rem}
      .gallery-art h2{font-size:1.6rem}
      .photo-gallery h2{font-size:1.6rem}
      .contact h2{font-size:1.6rem}
    }
    @media (max-width:480px){
      .hero{min-height:60vh;padding:2.5rem 1rem}
      .hero h1{font-size:1.8rem}
      .hero p{font-size:1rem; line-height:1.7;}
      .about{padding:2rem 1rem}
      .about-image img{width:220px;height:220px}
      .skills{padding:2rem 1rem}
      .portfolio{padding:2rem 1rem}
      .gallery-art{padding:2rem 1rem}
      .photo-gallery{padding:1.5rem 1rem}
      .upload{padding:2rem 1rem}
      .contact{padding:2rem 1rem}
      .portfolio-grid{grid-template-columns:1fr}
      .art-grid{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
      .photo-grid{grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
      .photo-grid img{height:120px}
      .photo-grid .photo-overlay{padding:10px}
      .photo-grid .photo-overlay h4{font-size:0.85rem}
      .photo-grid .photo-overlay p{font-size:0.75rem}
      .btn, button[type=submit]{padding:10px 18px;font-size:0.9rem}
      .nav{max-width:none;padding:0.75rem 1rem}
      .nav h1{font-size:0.9rem}
      .to-top{right:12px;bottom:12px;width:44px;height:44px}
    }

    .shake {
      animation: shake 0.5s;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>

  <header>
    <nav>
      <h1>Rangga Abi Yasha — 3D Artist</h1>
      <div class="nav-right">
        <div class="nav-links" id="navLinks">
          <a href="#Home" class="active">Home</a>
          <a href="#About">About</a>
          <a href="#SkillAplikasi">Skills</a>
          <a href="#Portofoliodigital">Portfolio</a>
          <a href="#GalleryArt">Gallery</a>
          <a href="upload.html">Upload</a>
          <a href="#Contact">Contact</a>
        </div>
        <div class="mobile-menu-toggle" id="mobileMenuToggle">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </nav>
  </header>

  <main>
    <!-- HOME -->
    <section id="Home" class="hero">
      <div class="hero-content container">
        <h1>Hai, saya Rangga Abi Yasha</h1>
        <p>3D Artist • Desainer Grafis • Video Editor — saya menggabungkan seni & teknologi untuk membuat pengalaman visual yang bermakna.</p>
        <a href="#Portofoliodigital" class="btn">Lihat Portofolio</a>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="About" class="about container">
      <div class="about-image">
        <img src="IMAGES/profil.jpg" alt="Foto Rangga Abi Yasha, 3D Artist dan Desainer Grafis" onerror="this.src='IMAGES/placeholder.jpg'" />
      </div>
      <div class="about-content">
        <h2>Tentang Saya</h2>
        <p>
          Saya Rangga Abi Yasha, seorang pelajar DKV yang sedang mendalami dunia <strong>3D Modeling</strong> dan <strong>desain digital</strong>.
          Saya menguasai Blender 3D, Substance Painter, dan ZBrush, serta alat desain seperti Photoshop dan Illustrator. Tujuan saya adalah
          menghasilkan karya yang bersinggungan antara storytelling, teknik, dan estetika.
        </p>
      </div>
    </section>

    <!-- SKILLS (3 kolom x 2 baris) -->
    <section id="SkillAplikasi" class="skills container">
      <div class="section-head">
        <h2>Skill & Aplikasi</h2>
      </div>

      <div class="skills-grid">
        <div class="skill-card">
          <h3>Blender</h3>
          <p>3D modeling, animation, rendering.</p>
          <div class="skill-row">
            <div class="progress"><div id="blender-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="blender-percent">0%</div>
          </div>
          <a href="blender.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>ZBrush</h3>
          <p>High-detail sculpting for characters & props.</p>
          <div class="skill-row">
            <div class="progress"><div id="zbrush-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="zbrush-percent">0%</div>
          </div>
          <a href="zbrush.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Substance Painter</h3>
          <p>PBR texturing & materials.</p>
          <div class="skill-row">
            <div class="progress"><div id="substance-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="substance-percent">0%</div>
          </div>
          <a href="substance.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Photoshop</h3>
          <p>Photo edit, compositing & digital painting.</p>
          <div class="skill-row">
            <div class="progress"><div id="photoshop-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="photoshop-percent">0%</div>
          </div>
          <a href="photoshop.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Illustrator</h3>
          <p>Vector art, logo, branding.</p>
          <div class="skill-row">
            <div class="progress"><div id="illustrator-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="illustrator-percent">0%</div>
          </div>
          <a href="illustrator.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Premiere Pro</h3>
          <p>Video editing, cutting, & color grading.</p>
          <div class="skill-row">
            <div class="progress"><div id="premiere-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="premiere-percent">0%</div>
          </div>
          <a href="premierpro.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Photography</h3>
          <p>Photo composition, editing & storytelling.</p>
          <div class="skill-row">
            <div class="progress"><div id="photography-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="photography-percent">0%</div>
          </div>
          <a href="fotogrfi.html" class="btn">Lihat Galeri</a>
        </div>

        <div class="skill-card">
          <h3>After Effects</h3>
          <p>Motion graphics, visual effects & compositing.</p>
          <div class="skill-row">
            <div class="progress"><div id="aftereffects-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="aftereffects-percent">0%</div>
          </div>
          <a href="aftereffects.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Digital Art</h3>
          <p>Digital painting, illustration & concept art.</p>
          <div class="skill-row">
            <div class="progress"><div id="digitalart-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="digitalart-percent">0%</div>
          </div>
          <a href="Digital Art.html" class="btn">Lihat Karya</a>
        </div>

        <div class="skill-card">
          <h3>Traditional Art</h3>
          <p>Sketching, painting & mixed media techniques.</p>
          <div class="skill-row">
            <div class="progress"><div id="traditionalart-bar" class="progress-bar" data-value="0%"></div></div>
            <div style="width:48px;text-align:right;font-weight:800;color:var(--accent)" id="traditionalart-percent">0%</div>
          </div>
          <a href="traditionalart.html" class="btn">Lihat Karya</a>
        </div>
      </div>
    </section>

    <!-- PORTFOLIO: hasil karya & deskripsi -->
    <section id="Portofoliodigital" class="portfolio container">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2>Portofolio Digital (3D & Desain Grafis)</h2>
        <div style="color:var(--muted)">Karya yang di-upload akan muncul di sini</div>
      </div>

      <!-- Search and Filter -->
      <div class="portfolio-filters">
        <input type="text" id="searchInput" placeholder="Cari berdasarkan deskripsi...">
        <select id="filterSelect">
          <option value="">Semua Aplikasi</option>
          <option value="blender">Blender</option>
          <option value="zbrush">ZBrush</option>
          <option value="substance">Substance Painter</option>
          <option value="photoshop">Photoshop</option>
          <option value="illustrator">Illustrator</option>
          <option value="premiere">Premiere Pro</option>
          <option value="fotogrfi">Photography</option>
          <option value="digitalart">Digital Art</option>
          <option value="traditionalart">Traditional Art</option>
        </select>
      </div>

      <div class="portfolio-grid" id="portfolioGrid">
        <!-- static examples (ke-3 awal) -->
        <div class="card" data-app="blender">
          <img src="IMAGES/blander1.jpeg" alt="3D Environment Sci-fi" loading="lazy" onerror="this.src='IMAGES/placeholder.jpg'">
          <div class="card-content">
            <h3>3D Environment Design</h3>
            <p>Futuristic sci-fi environment created in Blender with Substance Painter.</p>
          </div>
        </div>

        <div class="card" data-app="blender">
          <img src="IMAGES/blander2.jpeg" alt="Digital Poster Design" loading="lazy" onerror="this.src='IMAGES/placeholder.jpg'">
          <div class="card-content">
            <h3>3d label_modeling</h3>
            <p>Creative poster design combining 3D elements with dynamic typography.</p>
          </div>
        </div>

        <div class="card" data-app="blender">
          <img src="IMAGES/blander3.jpeg" alt="3D Character Concept" loading="lazy" onerror="this.src='IMAGES/placeholder.jpg'">
          <div class="card-content">
            <h3>3D Character Concept</h3>
            <p>Stylized 3D character design created with Blender and detailed in ZBrush.</p>
          </div>
        </div>

        <!-- dynamic uploads will be injected after the static cards -->
      </div>

      <div style="text-align:center;margin-top:2rem">
        <a href="upload.html" class="btn">Upload Karya Baru & Analisis AI</a>
        <br><br>
        <a href="all-gallery.html" class="btn" style="background: rgba(255,255,255,0.1); color: var(--accent); box-shadow: none;">Lihat Semua Galeri</a>
      </div>
    </section>

    <!-- KARYA TRADISIONAL & DIGITAL -->
    <section id="GalleryArt" class="gallery-art container">
      <h2>Karya Tradisional & Digital</h2>
      <p style="color:var(--muted)">10 karya terbaik dari kategori Digital Art dan Traditional Art.</p>
      <div class="art-grid">
        <!-- Top 10 Digital/Traditional Art akan dimuat di sini -->
      </div>
    </section>

    <!-- GALLERY FOTO -->
    <section class="photo-gallery container">
      <h2>Gallery Foto</h2>
      <p style="color:var(--muted);margin-bottom:2rem">10 karya fotografi terbaik dari koleksi saya. Klik untuk melihat lebih detail.</p>
      <div class="photo-grid">
        <!-- Top 10 Photography akan dimuat di sini -->
      </div>
    </section>



    <!-- CONTACT FORM -->
    <section id="Contact" class="contact container">
      <h2>Hubungi Saya</h2>
      <p style="color:var(--muted);margin-bottom:2rem">Kirim saran, pesan, atau pesan untuk pemesanan jasa desain. Pesan akan langsung dikirim ke WhatsApp saya.</p>

      <form id="contactForm" style="max-width:600px;margin:0 auto;background:linear-gradient(180deg,var(--panel),#07101a);padding:2rem;border-radius:12px;border:1px solid rgba(255,255,255,0.02);box-shadow:0 8px 30px rgba(0,0,0,0.6)">
        <div style="margin-bottom:1rem">
          <label for="contactName" style="display:block;color:var(--muted);font-weight:700;margin-bottom:0.5rem">Nama</label>
          <input type="text" id="contactName" required style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;font-family:inherit">
        </div>

        <div style="margin-bottom:1rem">
          <label for="contactEmail" style="display:block;color:var(--muted);font-weight:700;margin-bottom:0.5rem">Email (Opsional)</label>
          <input type="email" id="contactEmail" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;font-family:inherit">
        </div>

        <div style="margin-bottom:1rem">
          <label for="contactType" style="display:block;color:var(--muted);font-weight:700;margin-bottom:0.5rem">Jenis Pesan</label>
          <select id="contactType" required style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;font-family:inherit">
            <option value="" style="background:var(--panel);color:#eaf3fb">-- Pilih Jenis Pesan --</option>
            <option value="saran" style="background:var(--panel);color:#eaf3fb">Saran</option>
            <option value="pemesanan" style="background:var(--panel);color:#eaf3fb">Pemesanan Jasa</option>
            <option value="kolaborasi" style="background:var(--panel);color:#eaf3fb">Kolaborasi</option>
            <option value="lainnya" style="background:var(--panel);color:#eaf3fb">Lainnya</option>
          </select>
        </div>

        <div style="margin-bottom:1.5rem">
          <label for="contactMessage" style="display:block;color:var(--muted);font-weight:700;margin-bottom:0.5rem">Pesan</label>
          <textarea id="contactMessage" required rows="5" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;font-family:inherit;resize:vertical" placeholder="Tulis pesan Anda di sini..."></textarea>
        </div>

        <div id="contactError" style="color:#ff6b6b;margin-top:1rem;display:none;animation:fadeIn 0.5s;">Mohon lengkapi semua field yang wajib diisi.</div>
        <button type="submit" class="btn" style="width:100%;padding:14px;font-size:1rem">Kirim ke WhatsApp</button>
      </form>

      <h2 style="margin-top:3rem">Media Sosial</h2>
      <div style="margin-top:10px" class="contact-grid">
        <a href="https://www.instagram.com/bang._angga" target="_blank" aria-label="Instagram Rangga"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@bang._ang6" target="_blank" aria-label="TikTok Rangga"><i class="fab fa-tiktok"></i></a>
        <a href="https://www.linkedin.com/in/usernamekamu" target="_blank" aria-label="LinkedIn Rangga"><i class="fab fa-linkedin-in"></i></a>
        <a href="https://wa.me/6287860087460" target="_blank" aria-label="WhatsApp Rangga"><i class="fab fa-whatsapp"></i></a>
      </div>
    </section>

  </main>

  <div class="to-top" id="toTop" title="Kembali ke atas"><i class="fas fa-chevron-up"></i></div>

  <!-- modal for preview/analyzer -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="inner">
      <button id="modalClose" style="float:right;background:transparent;border:none;color:var(--muted);font-size:18px;cursor:pointer">&times;</button>
      <img id="modalImg" src="" alt="preview" onerror="this.src='IMAGES/placeholder.jpg'">
      <div class="meta" id="modalMeta"></div>
    </div>
  </div>

  <!-- modal for delete confirmation -->
  <div id="deleteModal" class="modal" aria-hidden="true">
    <div class="inner" style="max-width:400px;text-align:center;position:relative;">
      <button id="deleteModalClose" style="position:absolute;top:10px;right:10px;background:transparent;border:none;color:var(--muted);font-size:20px;cursor:pointer;transition:color 0.2s;">&times;</button>
      <h3 style="color:#fff;margin-bottom:1rem;">Konfirmasi Hapus</h3>
      <p style="color:var(--muted);margin-bottom:1rem;">Masukkan kode untuk menghapus karya ini:</p>
      <input type="password" id="deleteCode" placeholder="Masukkan kode..." style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;margin-bottom:1rem;transition:border-color 0.3s;">
      <div id="deleteError" style="color:#ff6b6b;margin-bottom:1rem;display:none;animation:fadeIn 0.5s;">Mohon maaf kode anda salah</div>
      <div id="deleteSuccess" style="color:#4caf50;margin-bottom:1rem;display:none;animation:fadeIn 0.5s;">Karya berhasil dihapus</div>
      <div style="display:flex;gap:10px;justify-content:center;">
        <button id="deleteConfirm" class="btn" style="flex:1;padding:10px;transition:transform 0.2s, box-shadow 0.2s;">Hapus</button>
        <button id="deleteCancel" style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#eaf3fb;cursor:pointer;transition:background 0.2s;">Batal</button>
      </div>
    </div>
  </div>

  <!-- lightbox for gallery -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <span class="close" id="lightboxClose">&times;</span>
    <img id="lightboxImg" src="" alt="lightbox">
  </div>

  <script type="module">
    // Import Firebase functions
    import { getUploads, deleteUploadFromFirebase, saveContactToFirebase } from "./firebase-uploads.js";
    import { animateValue } from "./ui-animation.js";

    /* ---------- Configuration ---------- */
    const APPS = ['blender','zbrush','substance','photoshop','premiere','fotogrfi','aftereffects','digitalart','traditionalart'];
    const ASPECT_WEIGHTS = { modeling:30, lighting:15, texturing:25, rendering:15, deskripsi:15 };

    /* ---------- Helpers ---------- */
    function getJSON(key, fallback){ try{ return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }catch(e){ return fallback; } }
    function saveJSON(key, val){ localStorage.setItem(key, JSON.stringify(val)); }

    // Unified and authoritative skill summary calculation
    async function getSkillSummary(){
      try {
        const uploads = await getUploads();
        const summary = {};
        APPS.forEach(app=>{
          const appUploads = uploads.filter(u=>u.app === app);
          if(appUploads.length > 0){
            const totalPercent = appUploads.reduce((sum, u)=> sum + (u.totalPercent || 0), 0);
            summary[app] = {
              average: Math.round(totalPercent / appUploads.length),
              count: appUploads.length
            };
          } else {
            summary[app] = { average: 0, count: 0 };
          }
        });
        return summary;
      } catch (error) {
        console.error("Error calculating skill summary:", error);
        return {};
      }
    }

    /* ---------- Load uploads and update UI ---------- */
    async function loadUploads(){
      try {
        const uploads = await getUploads();

        // sort by totalPercent desc (highest skill first)
        uploads.sort((a,b)=> (b.totalPercent || 0) - (a.totalPercent || 0));

        const grid = document.getElementById('portfolioGrid');
        const summary = await getSkillSummary(); // Calculate skill summary
        // remove dynamic children (keep first 3 static)
        while(grid.children.length > 3) grid.removeChild(grid.lastChild);

        // limit to top 10 for homepage, all apps
        const displayItems = uploads.slice(0, 10);

        displayItems.forEach(u=>{
          // create card
          const card = document.createElement('div'); card.className = 'card';
          card.setAttribute('data-app', u.app);
          const img = document.createElement('img');
          img.src = u.imageData || 'IMAGES/placeholder.jpg';
          img.alt = u.description || '';
          img.loading = 'lazy';
          img.onerror = function(){ this.src='IMAGES/placeholder.jpg'; };
          card.appendChild(img);
          const cardContent = document.createElement('div'); cardContent.className = 'card-content';
          const h3 = document.createElement('h3');
          h3.textContent = u.app ? u.app.toUpperCase() + ' — ' + (u.description || '') : (u.description || '');
          const p = document.createElement('p');
          p.textContent = 'Uploaded: ' + new Date(u.timestamp?.toDate ? u.timestamp.toDate() : u.timestamp || Date.now()).toLocaleString();
          cardContent.appendChild(h3);
          cardContent.appendChild(p);
          card.appendChild(cardContent);
          card.addEventListener('click', () => openModal(u));
          grid.appendChild(card);
        });
        // Add "View All" button
        const viewAllBtn = document.createElement('div');
        viewAllBtn.id = 'viewAllBtn';
        viewAllBtn.innerHTML = '<a href="all-gallery.html" class="btn" style="display:inline-block;">Lihat Selengkapnya</a>';
        grid.parentNode.insertBefore(viewAllBtn, grid.nextSibling);

        // --- Populate Gallery Art section (Top 10 Digital/Traditional Art) ---
        const artGrid = document.querySelector('#GalleryArt .art-grid');
        if (artGrid) {
          artGrid.innerHTML = ''; // Clear static content
          const digitalArtUploads = uploads.filter(u => u.app === 'digitalart' || u.app === 'traditionalart');
          digitalArtUploads.sort((a,b)=> (b.totalPercent || 0) - (a.totalPercent || 0));
          const top10Art = digitalArtUploads.slice(0, 10);

          if (top10Art.length === 0) {
            artGrid.innerHTML = '<p style="text-align:center; padding: 2rem; color: var(--muted);">Belum ada karya Digital/Traditional Art yang diunggah.</p>';
          } else {
            top10Art.forEach(u => {
                const artItem = document.createElement('div');
                artItem.className = 'art-item';
                const img = document.createElement('img');
                img.src = u.imageData || 'IMAGES/placeholder.jpg';
                img.alt = u.description || '';
                img.loading = 'lazy';
                img.onerror = function(){ this.src='IMAGES/placeholder.jpg'; };
                artItem.appendChild(img);
                artItem.addEventListener('click', () => openLightbox(img.src, img.alt));
                artGrid.appendChild(artItem);
            });
        }

        // --- Photo Gallery section (Top 10 Photography) ---
        const photoGrid = document.querySelector('.photo-gallery .photo-grid');
        if (photoGrid) {
          photoGrid.innerHTML = ''; // Clear static content
          const photographyUploads = uploads.filter(u => u.app === 'fotogrfi');
          photographyUploads.sort((a,b)=> (b.totalPercent || 0) - (a.totalPercent || 0));
          const top10Photos = photographyUploads.slice(0, 10);

          if (top10Photos.length === 0) {
            photoGrid.innerHTML = '<p style="text-align:center; padding: 2rem; color: var(--muted);">Belum ada karya Fotografi yang diunggah.</p>';
          } else {
            top10Photos.forEach(u => {
              const photoItem = document.createElement('div');
              photoItem.className = 'photo-item';
              const img = document.createElement('img');
              img.src = u.imageData || 'IMAGES/placeholder.jpg';
              img.alt = u.description || '';
              img.loading = 'lazy';
              img.onerror = function(){ this.src='IMAGES/placeholder.jpg'; };
              photoItem.appendChild(img);
              // for consistency with previous static items
              const overlay = document.createElement('div');
              overlay.className = 'photo-overlay';
              const h4 = document.createElement('h4');
              h4.textContent = u.description ? u.description.split(' ')[0] : '';
              const p = document.createElement('p');
              p.textContent = (u.description || '').slice(0, 50) + ((u.description && u.description.length > 50) ? '...' : '');
              overlay.appendChild(h4);
              overlay.appendChild(p);
              photoItem.appendChild(overlay);
              photoItem.addEventListener('click', () => openLightbox(img.src, img.alt));
              photoGrid.appendChild(photoItem);
            });
          }
        }

        // Helper function to animate number counting up
        function animateValue(obj, start, end, duration) {
          let startTimestamp = null;
          const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            const currentValue = Math.floor(progress * (end - start) + start);
            obj.innerHTML = currentValue + '%';
            if (progress < 1) {
              window.requestAnimationFrame(step);
            }
          };
          window.requestAnimationFrame(step);
        }

        // update skill bars from summary
        APPS.forEach(app=>{
          const bar = document.getElementById(app + '-bar');
          const pct = document.getElementById(app + '-percent');
          const avg = summary[app] ? summary[app].average : 0;
          const oldAvg = parseInt(pct.textContent) || 0;

          if(bar) bar.style.width = avg + '%'; // CSS transition will handle this
          // Selalu animasikan angka dari 0 ke rata-rata saat ini saat dimuat
          if(pct) animateValue(pct, 0, avg, 900);
        });
      } catch (error) {
        console.error("Error loading uploads:", error);
        const grid = document.getElementById('portfolioGrid');
        grid.innerHTML = '<p style="text-align:center; padding: 2rem; color: var(--muted);">Gagal memuat galeri. Coba refresh halaman.</p>';
      }
    }

    /* ---------- Search and Filter ---------- */
    function filterCards(){
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const filterApp = document.getElementById('filterSelect').value;
      const cards = document.querySelectorAll('#portfolioGrid .card');
      cards.forEach(card => {
        const title = card.querySelector('h3').textContent.toLowerCase();
        const desc = card.querySelector('p').textContent.toLowerCase();
        const app = card.querySelector('h3').textContent.split(' — ')[0].toLowerCase();
        const matchesSearch = title.includes(searchTerm) || desc.includes(searchTerm);
        const matchesFilter = !filterApp || app === filterApp;
        card.style.display = matchesSearch && matchesFilter ? 'block' : 'none';
      });
    }

    /* ---------- Modal / Analyzer ---------- */
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modalImg');
    const modalMeta = document.getElementById('modalMeta');
    const modalClose = document.getElementById('modalClose');

    function openModal(u){
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
      modalImg.src = u.imageData || 'IMAGES/placeholder.png';
      modalMeta.innerHTML = `<div style="color:var(--muted)"><strong>${u.app?u.app.toUpperCase():'Project'}</strong> — Uploaded: ${new Date(u.timestamp||Date.now()).toLocaleString()}</div>
        <div style="margin-top:8px;color:var(--muted)">${u.description||''}</div>
        <div style="margin-top:8px;color:var(--muted)"><strong>Final Skill:</strong> ${u.totalPercent? u.totalPercent+'%' : '—'}</div>
        <div style="margin-top:8px;color:var(--muted)"><strong>AI summary:</strong> ${u.aiText || '(tidak ada)'}</div>
        <button class="delete-btn" onclick="window.location.href='upload.html?edit=${u.id || u.timestamp}'" style="background:#333;color:#fff;">Edit</button>
        <button class="delete-btn" onclick="openDeleteModal('${u.id || u.timestamp}')">Hapus</button>`;
      window.location.hash = `karya=${u.id}`;
    }
    modalClose.addEventListener('click', ()=>{ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); });
    modal.addEventListener('click', (e)=>{ if(e.target === modal) { modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); } });

    // analyzer section (detailed) - not used as separate panel; modal shows details

    /* ---------- Lightbox for Gallery ---------- */
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightboxImg');
    const lightboxClose = document.getElementById('lightboxClose');

    function openLightbox(src, alt){
      lightbox.classList.add('open');
      lightbox.setAttribute('aria-hidden','false');
      lightboxImg.src = src;
      lightboxImg.alt = alt;
    }
    lightboxClose.addEventListener('click', ()=>{ lightbox.classList.remove('open'); lightbox.setAttribute('aria-hidden','true'); });
    lightbox.addEventListener('click', (e)=>{ if(e.target === lightbox) { lightbox.classList.remove('open'); lightbox.setAttribute('aria-hidden','true'); } });

    // attach lightbox to gallery images
    document.querySelectorAll('.art-item img, .photo-grid img').forEach(img => {
      img.addEventListener('click', () => openLightbox(img.src, img.alt));
    });

    // add fade-in animation to photo gallery items
    document.querySelectorAll('.photo-item').forEach((item, index) => {
      item.style.opacity = '0';
      item.style.transform = 'translateY(30px)';
      item.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
      setTimeout(() => {
        item.style.opacity = '1';
        item.style.transform = 'translateY(0)';
      }, index * 100);
    });

    /* ---------- Animations on Scroll ---------- */
    const observerOptions = { threshold: 0.1 };
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);

    // observe sections for fade-in
    document.querySelectorAll('.skills-grid .skill-card, .portfolio .card, .art-item').forEach(el => {
      el.style.opacity = '0';
      el.style.transform = 'translateY(20px)';
      el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
      observer.observe(el);
    });

    /* ---------- Mobile Menu Toggle ---------- */
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const navLinks = document.getElementById('navLinks');

    mobileMenuToggle.addEventListener('click', () => {
      navLinks.classList.toggle('active');
      mobileMenuToggle.classList.toggle('active');
    });

    // Close mobile menu when clicking a link
    navLinks.addEventListener('click', (e) => {
      if(e.target.tagName === 'A'){
        navLinks.classList.remove('active');
        mobileMenuToggle.classList.remove('active');
      }
    });

    /* ---------- Keyboard Navigation ---------- */
    document.addEventListener('keydown', (e) => {
      if(e.key === 'Escape'){
        if(modal.classList.contains('open')) modalClose.click();
        if(lightbox.classList.contains('open')) lightboxClose.click();
        // Close mobile menu on escape
        if(navLinks.classList.contains('active')){
          navLinks.classList.remove('active');
          mobileMenuToggle.classList.remove('active');
        }
      }
    });

    /* ---------- Delete Upload ---------- */
    function openDeleteModal(id){
      const deleteModal = document.getElementById('deleteModal');
      deleteModal.classList.add('open');
      deleteModal.setAttribute('aria-hidden','false');
      document.getElementById('deleteCode').value = '';
      document.getElementById('deleteError').style.display = 'none';
      document.getElementById('deleteSuccess').style.display = 'none';

      document.getElementById('deleteConfirm').onclick = () => {
        const code = document.getElementById('deleteCode').value;
        // Pengecekan kode hapus langsung
        if(code === '061008'){
          const uploads = getJSON('portfolio_uploads', []);
          const filtered = uploads.filter(u => (u.id || u.timestamp) !== id);
          saveJSON('portfolio_uploads', filtered);
        // Pengecekan kode hapus langsung
          setTimeout(() => {
            // Close all modals
            deleteModal.classList.remove('open');
            deleteModal.setAttribute('aria-hidden','true');
        // Pengecekan kode hapus langsung
            modal.classList.remove('open');
            modal.setAttribute('aria-hidden','true');
            // Reload data to refresh UI
            loadUploads();
        // Pengecekan kode hapus langsung
            filterCards(); // reapply filter
          }, 500);
        } else {
          document.getElementById('deleteError').style.display = 'block';
          document.getElementById('deleteCode').classList.add('shake');
          setTimeout(() => {
            document.getElementById('deleteCode').classList.remove('shake');
          }, 500);
        // Pengecekan kode hapus langsung
        }
      };

      document.getElementById('deleteCancel').onclick = () => {
        // Pengecekan kode hapus langsung
        deleteModal.classList.remove('open');
        deleteModal.setAttribute('aria-hidden','true');
      };

      deleteModal.addEventListener('click', (e) => {
        if(e.target === deleteModal) {
          deleteModal.classList.remove('open');
          deleteModal.setAttribute('aria-hidden','true');
        }
      });
    }

    /* ---------- Utilities & init ---------- */
    document.getElementById('toTop').addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));

    // Contact Form Handler
    document.getElementById('contactForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('contactName').value.trim();
      const email = document.getElementById('contactEmail').value.trim();
      const type = document.getElementById('contactType').value;
      const message = document.getElementById('contactMessage').value.trim();

      document.getElementById('contactError').style.display = 'none';
      if (!name || !type || !message) {
        document.getElementById('contactError').style.display = 'block';
        return;
      }

      try {
        // Save to Firebase first
        const contactData = { name, email, type, message };
        await saveContactToFirebase(contactData);

        // Construct WhatsApp message
        let waMessage = `*Pesan dari Portofolio Rangga*\n\n`;
        waMessage += `*Nama:* ${name}\n`;
        if (email) waMessage += `*Email:* ${email}\n`;
        waMessage += `*Jenis Pesan:* ${type}\n\n`;
        waMessage += `*Pesan:*\n${message}`;

        // Encode for URL
        const encodedMessage = encodeURIComponent(waMessage);
        const waUrl = `https://wa.me/6287860087460?text=${encodedMessage}`;

        // Open WhatsApp
        window.open(waUrl, '_blank');

        // Show success message
        alert('Pesan berhasil dikirim! Terima kasih atas pesan Anda.');

        // Reset form
        document.getElementById('contactForm').reset();
      } catch (error) {
        console.error('Error saving contact:', error);
        alert('Gagal mengirim pesan. Silakan coba lagi.');
      }
    });

    // initial set progress-bar width from data-value for static values
    document.addEventListener('DOMContentLoaded', ()=> {
      document.querySelectorAll('.progress-bar').forEach(bar=>{
        const v = bar.getAttribute('data-value') || '0%';
        setTimeout(()=>{ bar.style.width = v }, 120);
      });
      // load dynamic uploads & skill summary
      loadUploads();
      // add event listeners for search and filter
      document.getElementById('searchInput').addEventListener('input', filterCards);
      document.getElementById('filterSelect').addEventListener('change', filterCards);

      // attach lightbox to dynamic portfolio images
      document.querySelectorAll('#portfolioGrid .card img').forEach(img => {
        img.addEventListener('click', (e) => {
          e.stopPropagation(); // prevent modal
          openLightbox(img.src, img.alt);
        });
      });

      // Check for permalink on load
      if (window.location.hash.startsWith('#karya=')) {
        const workId = window.location.hash.substring(7);
        const allUploads = getJSON('portfolio_uploads', []);
        const workToShow = allUploads.find(u => u.id === workId);
        if (workToShow) {
          setTimeout(() => {
            openModal(workToShow);
          }, 300); // Small delay to ensure UI is ready
        }
      }
    });

    // Listen for localStorage changes from other tabs/windows to update UI in real-time
    window.addEventListener('storage', (e) => {
      if (e.key === 'portfolio_uploads') {
        loadUploads();
      }
    });


  </script>
</body>
</html>
